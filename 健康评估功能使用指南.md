# 健康评估功能使用指南

## 功能概述
健康评估功能利用DeepSeek AI技术，基于检客的体检数据自动生成专业、详细的健康评估报告。

## 系统要求
- 后端服务运行正常 (http://localhost:5000)
- 前端服务运行正常 (http://localhost:8080)
- DeepSeek API已正确配置

## 使用流程

### 第一步：登录系统
1. 访问 http://localhost:8080
2. 使用管理员账户登录 (admin/admin123)

### 第二步：进入报告查看页面
1. 在主导航栏点击"报告查看"
2. 系统显示报告生成界面

### 第三步：选择健康评估类型
1. 点击"健康评估"按钮
2. 系统自动显示健康评估专用界面

### 第四步：选择检客
1. 在"搜索检客"输入框中输入检客姓名或身份证号
2. 从搜索结果中选择目标检客
3. 确认检客信息显示正确

### 第五步：设置搜索范围
1. 在"健康数据日期范围"中选择起止日期
2. 点击"搜索健康数据"按钮
3. 系统显示可用的体检报告列表

### 第六步：选择体检报告
1. 从下拉列表中选择要生成健康评估的体检报告
2. 系统自动检查是否已生成过健康评估
3. 显示相应的状态提示

### 第七步：生成健康评估
1. 点击"生成报告"按钮
2. 如果是首次生成，系统会：
   - 显示"正在生成健康评估..."提示
   - 异步调用DeepSeek API进行分析
   - 自动轮询处理状态
3. 如果已存在，直接显示报告内容

### 第八步：查看和下载报告
1. 系统在模态框中显示生成的健康评估报告
2. 报告包含：
   - 基本信息（姓名、体检ID、生成时间）
   - AI健康评估分析
   - 健康建议和注意事项
3. 点击"下载报告"按钮可下载Markdown格式文件

## 功能特点

### 🤖 AI智能分析
- 基于DeepSeek大语言模型
- 专业医疗术语和通俗易懂的解释
- 个性化健康建议

### 📊 数据整合
- 自动整合多个科室的体检数据
- 支持检验科、影像科等各类检查结果
- 智能数据格式化和处理

### 💾 状态管理
- 实时显示生成进度
- 自动避免重复生成
- 完整的API调用记录

### 📱 用户友好
- 直观的操作界面
- 清晰的状态提示
- 一键下载功能

## 注意事项

### ⚠️ 重要提醒
1. **API配置要求**：使用前必须正确配置DeepSeek API Key
2. **网络要求**：需要稳定的网络连接访问DeepSeek服务
3. **数据要求**：确保检客有完整的体检数据
4. **时间要求**：AI生成过程可能需要几秒到几十秒

### 🔒 隐私和安全
- 所有API调用记录已加密存储
- 体检数据仅在API调用时临时传输
- 支持手动删除敏感报告

### 💰 成本控制
- DeepSeek API按token使用量计费
- 系统记录每次调用的消耗量
- 建议合理控制生成频率

## 故障处理

### 常见问题及解决方案

#### 1. "DeepSeek API未配置"错误
**原因**：后端环境变量未正确设置
**解决**：按照 `DEEPSEEK_SETUP.md` 配置API Key

#### 2. "生成健康评估失败"错误
**原因**：网络问题或API调用异常
**解决**：
- 检查网络连接
- 验证API Key有效性
- 查看后端日志获取详细错误

#### 3. "未找到体检数据"提示
**原因**：选择的检客在指定日期范围内无体检记录
**解决**：
- 扩大日期范围搜索
- 确认检客有体检数据
- 检查数据库连接

#### 4. 页面加载异常
**原因**：前端或后端服务未正常启动
**解决**：
- 检查服务是否在正确端口运行
- 刷新浏览器页面
- 查看浏览器控制台错误信息

## 最佳实践

### 🎯 使用建议
1. **数据质量**：确保体检数据完整准确
2. **定期更新**：建议为检客定期生成新的健康评估
3. **结果解读**：AI评估仅供参考，重要健康问题请咨询专业医生
4. **存储管理**：定期清理不需要的历史报告

### 📈 效果优化
1. **选择合适的日期范围**：建议选择最近3-6个月的体检数据
2. **数据完整性**：确保包含主要科室的检查结果
3. **模型选择**：根据需要选择合适的AI模型

---

## 技术支持

如需技术支持或遇到问题，请：
1. 查看 `DEEPSEEK_SETUP.md` 配置指南
2. 检查后端控制台日志
3. 确认所有服务正常运行
4. 验证网络连接和API配置

**功能开发完成！** 🎉 系统现在已完全支持AI驱动的健康评估功能。